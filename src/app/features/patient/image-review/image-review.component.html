<div class="fixed inset-0 bg-black/60 flex items-center justify-center z-50" (click)="closePopup()">
  <div class="relative bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-auto" 
       (click)="$event.stopPropagation()">
    
    <!-- Close button -->
    <button 
      class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition-colors"
      (click)="closePopup()">
      <mat-icon class="text-2xl">close</mat-icon>
    </button>

    <!-- Progress bar -->
    @if (progress() < 100) {
      <div class="p-8">
        <mat-progress-bar 
          mode="determinate" 
          [value]="progress()"
          class="mb-4">
        </mat-progress-bar>
        <p class="text-center text-gray-600">
          Downloading image... {{ progress() }}%
        </p>
      </div>
    }

    <!-- Image display -->
    @if (imageSrc()) {
      <div class="p-4">
        <img 
          [src]="imageSrc()!" 
          alt="Medical Image"
          class="w-full h-auto rounded-lg shadow-md" 
        />
      </div>
    }
  </div>
</div>
